<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced PDF E-book Reader</title>
    <link rel="stylesheet" href="style.css">
    <!-- PDF.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <!-- Quill Rich Text Editor CDN -->
    <link href="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.min.js"></script>
</head>

<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <h1>ğŸ“š Enhanced PDF Reader</h1>
                <div class="header-controls">
                    <button id="toggleSidebar" class="btn btn--secondary btn--sm">
                        <span id="sidebarToggleIcon">â—€</span> Toggle Sidebar
                    </button>
                    <button id="toggleRightPanel" class="btn btn--secondary btn--sm">
                        Toggle Right Panel <span id="rightPanelToggleIcon">â–¶</span>
                    </button>
                    <button id="fullscreen" class="btn btn--outline btn--sm">â›¶ Fullscreen</button>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="app-main">
            <!-- Left Sidebar -->
            <aside class="sidebar" id="leftSidebar">
                <!-- Upload Section -->
                <section class="sidebar-section upload-section">
                    <div class="sidebar-section-header">
                        <h3>ğŸ“ Upload PDF</h3>
                    </div>
                    <div class="upload-content">
                        <div class="upload-area-compact">
                            <div class="upload-icon">ğŸ“„</div>
                            <button id="uploadBtn" class="btn btn--primary">Choose PDF File</button>
                            <input type="file" id="fileInput" accept=".pdf" hidden>
                            <div class="upload-hint">
                                <small>Or drag and drop a PDF file here</small>
                            </div>
                        </div>
                        <div id="fileInfo" class="file-info hidden">
                            <div class="file-name" id="fileName"></div>
                            <div class="file-status" id="fileStatus"></div>
                        </div>
                    </div>
                </section>

                <!-- Table of Contents Section -->
                <section class="sidebar-section toc-section">
                    <div class="sidebar-section-header">
                        <h3>ğŸ“– Table of Contents</h3>
                        <span class="toc-status" id="tocStatus">No PDF loaded</span>
                    </div>
                    <div class="toc-container" id="tocContainer">
                        <div class="toc-placeholder">
                            <p>ğŸ“„ Upload a PDF to see the table of contents</p>
                        </div>
                    </div>
                </section>
            </aside>

            <!-- Center Content Area -->
            <div class="content-area">
                <!-- PDF Reader Controls -->
                <div class="reader-controls">
                    <div class="nav-controls">
                        <button id="prevPage" class="btn btn--secondary btn--sm">â† Previous</button>
                        <span class="page-info" id="pageInfo">No PDF loaded</span>
                        <button id="nextPage" class="btn btn--secondary btn--sm">Next â†’</button>
                    </div>

                    <div class="zoom-controls">
                        <button id="zoomOut" class="btn btn--secondary btn--sm">-</button>
                        <span class="zoom-info-container">
                            <input type="text" id="zoomInfo" class="zoom-input" value="100%" readonly>
                        </span>
                        <button id="zoomIn" class="btn btn--secondary btn--sm">+</button>
                        <button id="fitWidth" class="btn btn--outline btn--sm">Fit Width</button>
                        <button id="toggleView" class="btn btn--outline btn--sm">Double Page</button>
                    </div>
                </div>

                <!-- PDF Container -->
                <div class="reader-area">
                    <div class="pdf-container" id="pdfContainer">
                        <div class="pdf-placeholder" id="pdfPlaceholder">
                            <div class="placeholder-content">
                                <div class="placeholder-icon">ğŸ“–</div>
                                <h2>Welcome to Enhanced PDF Reader</h2>
                                <p>Upload a PDF file from the sidebar to start reading</p>
                                <ul class="feature-list">
                                    <li>âœ¨ Interactive table of contents</li>
                                    <li>ğŸ” Zoom and navigation controls</li>
                                    <li>âœï¸ Text highlighting and notes</li>
                                    <li>ğŸ¤– AI-powered document analysis</li>
                                    <li>ğŸ“± Responsive design</li>
                                </ul>
                            </div>
                        </div>
                        <canvas id="pdfCanvas" class="pdf-canvas hidden"></canvas>
                        <canvas id="pdfCanvas2" class="pdf-canvas hidden"></canvas>
                        <div id="textLayer" class="text-layer"></div>
                        <div id="highlightLayer" class="highlight-layer"></div>
                    </div>
                </div>
            </div>

            <!-- Right Panel -->
            <aside class="right-panel" id="rightPanel">
                <!-- AI Agent Section -->
                <section class="panel-section ai-section">
                    <div class="panel-section-header">
                        <h3>ğŸ¤– AI Assistant</h3>
                        <button id="clearChat" class="btn btn--secondary btn--sm">Clear</button>
                    </div>
                    <div class="ai-content">
                        <div class="ai-chat-container" id="aiChatContainer">
                            <div class="ai-message system-message">
                                <p>ğŸ‘‹ Hi! I'm your AI assistant. Upload a PDF and I'll help you analyze and understand
                                    its content. Ask me questions about the document!</p>
                            </div>
                        </div>
                        <div class="ai-input-area">
                            <div class="api-key-setup" id="apiKeySetup">
                                <input type="password" id="apiKeyInput" placeholder="Enter your OpenAI API key..."
                                    class="form-control">
                                <button id="saveApiKey" class="btn btn--primary btn--sm">Save Key</button>
                            </div>
                            <div class="chat-input-container hidden" id="chatInputContainer">
                                <textarea id="aiInput" placeholder="Ask a question about the document..." rows="2"
                                    class="form-control"></textarea>
                                <button id="sendMessage" class="btn btn--primary btn--sm">Send</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Highlights Section -->
                <section class="panel-section highlights-section">
                    <div class="panel-section-header">
                        <h3>âœ¨ Highlights</h3>
                        <button id="clearHighlights" class="btn btn--secondary btn--sm">Clear All</button>
                    </div>
                    <div class="highlights-content" id="highlightsContent">
                        <div class="highlights-placeholder">
                            <p>ğŸ“ Highlighted text will appear here</p>
                            <small>Select text in the PDF to highlight it</small>
                        </div>
                    </div>
                </section>

                <!-- Notes Section -->
                <section class="panel-section notes-section">
                    <div class="panel-section-header">
                        <h3>ğŸ“ Notes</h3>
                        <button id="saveNotes" class="btn btn--primary btn--sm">Save</button>
                    </div>
                    <div class="notes-content">
                        <div id="notesEditor" class="notes-editor"></div>
                    </div>
                </section>

                <!-- Quick Access Icons -->
                <div class="quick-access-icons">
                    <button id="quickAI" class="quick-icon" title="AI Assistant">ğŸ¤–</button>
                    <button id="quickHighlights" class="quick-icon" title="Highlights">âœ¨</button>
                    <button id="quickNotes" class="quick-icon" title="Notes">ğŸ“</button>
                </div>
            </aside>
        </main>
    </div>

    <!-- Loading Indicator -->
    <div class="loading-indicator hidden" id="loadingIndicator">
        <div class="loading-spinner"></div>
        <p id="loadingText">Loading PDF...</p>
    </div>

    <!-- Error Modal -->
    <div class="modal hidden" id="errorModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>âŒ Error</h3>
                <button id="closeError" class="btn btn--secondary btn--sm">Ã—</button>
            </div>
            <div class="modal-body">
                <p id="errorMessage">An error occurred while processing the PDF.</p>
            </div>
            <div class="modal-footer">
                <button id="errorOk" class="btn btn--primary">OK</button>
            </div>
        </div>
    </div>

    <!-- Highlight Context Menu -->
    <div class="context-menu hidden" id="highlightMenu">
        <button id="highlightYellow" class="context-menu-item">ğŸŸ¡ Yellow</button>
        <button id="highlightGreen" class="context-menu-item">ğŸŸ¢ Green</button>
        <button id="highlightBlue" class="context-menu-item">ğŸ”µ Blue</button>
        <button id="highlightRed" class="context-menu-item">ğŸ”´ Red</button>
        <button id="removeHighlight" class="context-menu-item">âŒ Remove</button>
    </div>

    <script src="app.js"></script>
</body>

</html>